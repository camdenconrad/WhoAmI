<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:WhoAmI.ViewModels"
        x:Class="WhoAmI.UI.MainWindow"
        Title="WhoAmI - High-Dimensional Personality Assessment"
        Width="900" Height="700"
        MinWidth="700" MinHeight="500">

    <Design.DataContext>
        <vm:MainViewModel />
    </Design.DataContext>

    <Grid Margin="20">
        <!-- Welcome Screen -->
        <StackPanel IsVisible="{Binding IsWelcomeScreen}" VerticalAlignment="Center" HorizontalAlignment="Center" MaxWidth="600">
            <TextBlock Text="WhoAmI" FontSize="48" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,20" />
            <TextBlock Text="High-Dimensional Personality Assessment" FontSize="20" HorizontalAlignment="Center" Margin="0,0,0,40" />
            
            <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,10">
                This assessment maps your cognitive patterns in high-dimensional space, avoiding traditional personality "buckets."
            </TextBlock>
            
            <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,10">
                • Choose options based on your ACTUAL behavior, not your ideal self
            </TextBlock>
            <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,10">
                • Each choice activates multiple trait dimensions simultaneously
            </TextBlock>
            <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,30">
                • Contradictions are preserved as features, not bugs
            </TextBlock>
            
            <Button Content="Start Assessment" 
                    HorizontalAlignment="Center" 
                    Padding="30,15"
                    FontSize="16"
                    Click="StartTest_Click" />
        </StackPanel>

        <!-- Test In Progress -->
        <StackPanel IsVisible="{Binding IsTestInProgress}">
            <TextBlock Text="{Binding ProgressText}" FontSize="16" Margin="0,0,0,20" HorizontalAlignment="Center" />
            
            <Border BorderBrush="Gray" BorderThickness="1" Padding="20" CornerRadius="8" Margin="0,0,0,20">
                <StackPanel>
                    <TextBlock Text="{Binding CurrentQuestion.Context}" FontSize="12" Foreground="Gray" Margin="0,0,0,10" />
                    <TextBlock Text="{Binding CurrentQuestion.Scenario}" 
                               FontSize="18" 
                               FontWeight="SemiBold" 
                               TextWrapping="Wrap"
                               Margin="0,0,0,20" />
                    
                    <ItemsControl ItemsSource="{Binding CurrentQuestion.Options}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Content="{Binding Description}"
                                        Tag="{Binding Label}"
                                        Click="AnswerOption_Click"
                                        HorizontalAlignment="Stretch"
                                        HorizontalContentAlignment="Left"
                                        Padding="15,12"
                                        Margin="0,0,0,10">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <Border Background="{TemplateBinding Background}"
                                                    BorderBrush="LightGray"
                                                    BorderThickness="1"
                                                    CornerRadius="6"
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter Content="{TemplateBinding Content}" />
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Results Screen -->
        <ScrollViewer IsVisible="{Binding IsTestComplete}">
            <StackPanel>
                <TextBlock Text="Your Personality Profile" FontSize="32" FontWeight="Bold" Margin="0,0,0,30" HorizontalAlignment="Center" />
                
                <!-- MBTI Type -->
                <Border BorderBrush="Gray" BorderThickness="2" Padding="20" CornerRadius="8" Margin="0,0,0,20" Background="#f0f0f0">
                    <StackPanel>
                        <TextBlock Text="16 Personalities Type" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,10" />
                        <TextBlock Text="{Binding MBTITypeDisplay}" FontSize="16" TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!-- High-Dimensional Profile -->
                <Border BorderBrush="Gray" BorderThickness="1" Padding="20" CornerRadius="8" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="High-Dimensional Profile" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15" />
                        <TextBlock Text="Your personality exists in multi-dimensional space. The 16 Personalities type above is a simplified projection." 
                                   TextWrapping="Wrap" 
                                   FontSize="13" 
                                   Foreground="Gray"
                                   Margin="0,0,0,15" />
                        
                        <TextBlock Text="Dominant Traits" FontWeight="SemiBold" Margin="0,0,0,8" />
                        <ItemsControl ItemsSource="{Binding Profile.DominantTraits}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Margin="0,2">
                                        <Run Text="{Binding TraitId}" />
                                        <Run Text=": " />
                                        <Run Text="{Binding TotalStrength, StringFormat={}{0:F2}}" />
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="Personality Metrics" FontWeight="SemiBold" Margin="0,15,0,8" />
                        <StackPanel>
                            <TextBlock>
                                <Run Text="Trait Diversity: " />
                                <Run Text="{Binding Profile.TraitDiversity}" />
                                <Run Text=" (complexity)" Foreground="Gray" />
                            </TextBlock>
                            <TextBlock>
                                <Run Text="Context Variance: " />
                                <Run Text="{Binding Profile.ContextVariance, StringFormat={}{0:F2}}" />
                                <Run Text=" (adaptability)" Foreground="Gray" />
                            </TextBlock>
                            <TextBlock>
                                <Run Text="Contradiction Tolerance: " />
                                <Run Text="{Binding Profile.ContradictionTolerance, StringFormat={}{0:F2}}" />
                                <Run Text=" (nuance)" Foreground="Gray" />
                            </TextBlock>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Save Button -->
                <Button Content="Save Results (JSON + TXT)" 
                        HorizontalAlignment="Center" 
                        Padding="30,15"
                        FontSize="16"
                        Click="SaveResults_Click"
                        Margin="0,10,0,0" />
                        
                <Button Content="Take Test Again" 
                        HorizontalAlignment="Center" 
                        Padding="30,15"
                        FontSize="14"
                        Click="RestartTest_Click"
                        Margin="0,10,0,20" />
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
